#ifndef _AES_H
#define _AES_H

/****************************************************************************
*  Include Files
*****************************************************************************/


/*****************************************************************************
*  Define
******************************************************************************/
//?bit????????,??? 128,192 ? 256 ??
#define AES_KEY_LENGTH 128

//?????
#define AES_MODE_ECB 1    // ???????
#define AES_MODE_CBC 0    // ????????
#define AES_MODE  AES_MODE_ECB // ??????

/*****************************************************************************
*  Functions Define
******************************************************************************/

/******************************************************************************
// ???: AES_Init
// ??:  ???,???????????
// ????: pKey -- ????,?????? AES_KEY_LENGTH/8 ???
// ????: ??
// ???: ??
******************************************************************************/
extern void AES_Init(const void* pKey);

/******************************************************************************
// ???: AES_Encrypt
// ??:  ????
// ????: pPlainText -- ??,???????,????nDataLen???
//    nDataLen -- ????,??????,???AES_KEY_LENGTH/8?????
//    pIV   -- ?????,????ECB??,???NULL?
// ????: pCipherText -- ??,??????????,???pPlainText???
// ???: ??
******************************************************************************/
void AES_Encrypt(const unsigned char* pPlainText, unsigned char* pCipherText,
    unsigned int nDataLen, const unsigned char* pIV);

/******************************************************************************
// ???: AES_Decrypt
// ??:  ????
// ????: pCipherText -- ??,???????,????nDataLen???
//    nDataLen -- ????,??????,???AES_KEY_LENGTH/8?????
//    pIV   -- ?????,????ECB??,???NULL?
// ????: pPlainText  -- ??,??????????,???pCipherText???
// ???: ??
******************************************************************************/
void AES_Decrypt(unsigned char* pPlainText, const unsigned char* pCipherText,
    unsigned int nDataLen, const unsigned char* pIV);

/*****************************************************************************
// ???: AES_add_pkcs7Padding
// ??:  PKCS7Padding????
// ????: input -- ??????16????????????
//    len --  ?????
// ????: input  -- ?????????
// ???: ??????
*****************************************************************************/
unsigned int AES_add_pkcs7Padding(unsigned char* input, unsigned int len);

/*****************************************************************************
// ???: AES_delete_pkcs7Padding
// ??:  PKCS7Padding????????????
// ????: input -- ??????
//    len --  ?????
// ????: input  -- ?????????
// ???: ????????????,?0?????????
*****************************************************************************/
unsigned int AES_delete_pkcs7Padding(unsigned char* input, unsigned int len);
#endif  /* _AES_H */


